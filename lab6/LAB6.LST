Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-1


       1				.386 
       2				;======================================
					================ 
       3				; –ú–û–î–ï–õ–¨ –ú–£–õ–¨–¢–ò–ü–†–û–ì–†–ê
					–ú–ù–û–á –°–ò–°–¢–ï–ú–ò 
       4				;======================================
					================ 
       5 = 000A				max_prg equ 10 ;–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ 
					–∫—ñ–ª—å–∫—ñ—Å—Ç—å "–æ–¥–Ω–æ—á–∞—Å–Ω–æ"
					 –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏—Ö –∑–∞–¥–∞—á  
       6 = FFFF				time_slice equ 65535; –∫—ñ–ª—å–∫—ñ—Å—Ç—
					å –º—ñ–∫—Ä–æ—Å–µ–∫—É–Ω–¥, –≤–∏–¥—ñ–ª–µ–
					Ω–∏—Ö –Ω–∞ –æ–¥–∏–Ω –∫–≤–∞–Ω—Ç —á–∞—Å—É
					 (–º–∞–∫—Å–∏–º–
       7				 
       8 0000				_ST SEGMENT WORD STACK 'stack' use16 
       9 0000  7D00[				dw 32000 dup (?) 
      10	   ????			
      11			 ]	
      12				
      13 FA00					top label word 
      14 FA00  0064[				dw 100 dup (?) ;—Ä–µ–∑–µ—Ä–≤ –¥
					–ª—è –ø–æ–º–∏–ª–æ–∫ –∞–Ω—Ç–∏ –ø–µ—Ä–µ–ø
					–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫–∞ 
      15	   ????			
      16			 ]	
      17				
      18 FAC8				_ST ENDS 
      19				 
      20 0000				_DATA SEGMENT WORD PUBLIC 'DATA' use16 
      21 0000  ????????				@ms_dos_busy dd (?) ; –ª–æ–≥—ñ—
					á–Ω–∞ –∞–¥—Ä–µ—Å–∞ –æ–∑–Ω–∞–∫–∏ –∑–∞–π–
					Ω—è—Ç–æ—Å—Ç—ñ MS-DOS 
      22				 
      23 0004  00				int8set db 0 ;–æ–∑–Ω–∞–∫–∞ –ø–µ
					—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω
					–Ω—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
      24 0005  00				int9set db 0 ;–æ–∑–Ω–∞–∫–∞ –ø–µ
					—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω
					–Ω—è –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ 
      25				 
      26 =					fon equ max_prg ; –æ–∑–Ω–∞–∫–∞ 
					—Ñ–æ–Ω–æ–≤–æ—ó –∑–∞–¥–∞—á—ñ; 
      27 0006					fonsp label word ;–∞–¥—Ä–µ—Å–∞ 
					–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è SP —Ñ–æ–Ω–æ–≤–æ—ó 
					–∑–∞–¥–∞—á—ñ 
      28 0006  FA00 ---- R			sssp dd top ;–ª–æ–≥—ñ—á–Ω–∞ –∞–
					¥—Ä–µ—Å–∞ —Å—Ç–µ–∫–∞ —Ñ–æ–Ω–æ–≤–æ—ó –∑–
					∞–¥–∞—á—ñ 
      29				 
      30				; –º–∞—Å–∏–≤ –∑–Ω–∞—á–µ–Ω—å SP –¥–ª—è –
					∑–∞–¥–∞—á, (–¥–ª—è —Å—Ç–µ–∫–∞ –∫–æ–∂–Ω–
					æ—ó –∑–∞–¥–∞—á—ñ –≤—ñ–¥–≤–µ–¥–µ–Ω–æ 100
					0 —Å–ª—ñ–≤) 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-2


      31				;–∑–∞–¥–∞–Ω—ñ –ø–æ—á–∞—Ç–∫–æ–≤—ñ –∑–Ω–∞
					—á–µ–Ω–Ω—è  
      32 000A  03E8 07D0 0BB8 0FA0		stp dw 1000,2000,3000,4000 
      33 0012  1388 1770 1B58 1F40			dw 5000,6000,7000,8000 
      34 001A  2328 2710 2AF8 2EE0			dw 9000,10000,11000,120
					00 
      35 0022  32C8 36B0 3A98 3E80			dw 13000,14000,15000,16
					000 
      36				 
      37				 
      38 002A  0000				nprg dw 0 ;–Ω–æ–º–µ—Ä –∞–∫—Ç–∏–
					≤–Ω–æ—ó –∑–∞–¥–∞—á—ñ (–≤—ñ–¥ 0 –¥–æ  
      39					;max_prg-1) 
      40					; –∞–±–æ –æ–∑–Ω–∞–∫–∞ —Ñ–æ–Ω–æ–
					≤–æ—ó –∑–∞–¥–∞—á—ñ (fon) 
      41				 
      42					; –º–∞—Å–∏–≤ —Å—Ç–∞–Ω—É –∑–∞–¥–
					∞—á 
      43 002C  0010[				init db 16 dup (0) 
      44	   00			
      45			 ]	
      46				
      47				 
      48					; –º–∞—Å–∏–≤ –¥–æ–∑–≤–æ–ª–µ–Ω–æ
					–≥–æ —á–∏—Å–ª–∞ –∫–≤–∞–Ω—Ç—ñ–≤ –∑–∞–¥–∞
					—á 
      49 003C  0010[				clock db 16 dup (1) 
      50	   01			
      51			 ]	
      52				
      53				 
      54					; –º–∞—Å–∏–≤ –ª—ñ—á–∏–ª—å–Ω–∏–∫
					—ñ–≤ –∫–≤–∞–Ω—Ç—ñ–≤ –∑–∞–¥–∞—á  
      55 004C  0010[				clockt db 16 dup (0) 
      56	   00			
      57			 ]	
      58				
      59				 
      60 005C  0010[				screen_addr dw 16 dup (0) ; –∞–
					¥—Ä–µ—Å–∞ (–∑–º—ñ—â–µ–Ω–Ω—è –≤—ñ–¥ –ø–æ
					—á–∞—Ç–∫—É –≤—ñ–¥–µ–æ—Å—Ç–æ—Ä—ñ–Ω–∫–∏) 
      61	   0000			
      62			 ]	
      63				
      64					; –æ–±–ª–∞—Å—Ç—ñ –≤–≤–µ–¥–µ–Ω–Ω
					—è –Ω–∞ –µ–∫—Ä–∞–Ω –∑–Ω–∞—á–µ–Ω—å –∑–∞–
					¥–∞—á—ñ 
      65				 
      66					; –º–∞—Å–∏–≤ —ñ–º–µ–Ω –∑–∞–¥–∞—
					á 
      67 007C					names label word 
      68 007C  30 54 31 54 32 54 33		db '0T1T2T3T4T5T6T7T8T9TATBTCTD
					TETFT' 
      69       54 34 54 35 54 36 54	
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-3


      70       37 54 38 54 39 54 41	
      71       54 42 54 43 54 44 54	
      72       45 54 46 54		
      73 009C  0000				clk dw 0 ;–ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø
					–µ—Ä–µ—Ä–∏–≤–∞–Ω—å –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–
					∞  
      74				 
      75 009E  0000				mouse_state dw 0 
      76 00A0  0000				cursor_pos dw 0 
      77 00A2				_DATA ENDS 
      78				 
      79 0000				_TEXT SEGMENT BYTE PUBLIC 'CODE' use16 
      80					ASSUME CS:_TEXT,DS:_DATA 
      81				 
      82				;--------------------------------------
					---------------------- 
      83				; –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ "–ø–µ—Ä–µ—Ö–æ–ø–ª–
					µ–Ω–Ω—è" –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ 
					—Ç–∞–π–º–µ—Ä–∞ (int8) 
      84				;--------------------------------------
					---------------------- 
      85 0000				setint8 PROC 
      86				;--------------------------------------
					---------------------- 
      87 0000  A0 0004 R			mov al,int8set 
      88 0003  0A C0				or al,al ; –∫–æ–Ω—Ç—Ä–æ–ª—å "–ø
					–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è" –ø–µ—Ä–µ—Ö–æ–ø–
					ª–µ–Ω—å 
      89 0005  0F 85 0037 R			jnz zero_8 ; 
      90 0009  B4 35				MOV AH,35H ; –æ—Ç—Ä–∏–º–∞—Ç–∏ –
					≤–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è 
      91 000B  B0 08				MOV AL,8 ; –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω
					—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ (8) 
      92 000D  CD 21				INT 21H ; –∑–Ω–∞—á–µ–Ω–Ω—è —â–æ
					 –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è: 
      93					 ; es:bx - –ª–æ–≥—ñ—á–Ω–∞ –∞–¥—
					Ä–µ—Å–∞ —Å–∏—Å—Ç–µ–º–Ω–æ—ó –ø—Ä–æ—Ü–µ–¥
					—É—Ä–∏ 
      94					 ; –æ–±—Ä–æ–±–∫–∏ –ø–µ—Ä–µ—Ä–∏–
					≤–∞–Ω–Ω—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
      95				 
      96 000F  2E: 89 1E 0038 R			mov cs:int8ptr,bx ; –∑–±–µ—Ä–µ–
					≥—Ç–∏ –ª–æ–≥—ñ—á–Ω—É –∞–¥—Ä–µ—Å—É —Å–∏—
					Å—Ç–µ–º–Ω–æ—ó 
      97 0014  2E: 8C 06 003A R			mov cs:int8ptr+2,es ; –ø—Ä–æ—Ü–
					µ–¥—É—Ä–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç—ñ –∫–æ–¥—ñ–
					≤ 
      98				 
      99 0019  BA 00F3 R			mov dx,offset userint8 ;—Ñ–æ—Ä–
					º—É–≤–∞–Ω–Ω—è –≤ ds:dx –ª–æ–≥—ñ—á–Ω–æ—ó
					 
     100 001C  1E				push ds ; –∞–¥—Ä–µ—Å–∏ –ø—Ä–æ—Ü
					–µ–¥—É—Ä–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ 
     101 001D  0E				push cs ; –¥–ª—è –æ–±—Ä–æ–±–∫–∏
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-4


					 –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω—å –≤—ñ–¥ —Ç–∞–π–º–µ
					—Ä–∞ 
     102 001E  1F				pop ds 
     103				 
     104 001F  B4 25				MOV AH,25H ; –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç
					–∏ –≤–µ–∫—Ç–æ—Ä 
     105 0021  B0 08				MOV AL,8 ; –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω
					—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
     106 0023  CD 21				INT 21H ; ds:dx - –ø–æ–∫–∞–∂—á–
					∏–∫ –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—É 
     107					; –ø—Ä–æ—Ü–µ–¥—É—Ä—É –æ–±—Ä–æ–±
					. –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ ;—Ç–∞–π
					–º–µ—Ä–∞ 
     108				 
     109				 
     110 0025  B8 FFFF				mov ax,time_slice ; –≤—Å—Ç–∞–Ω–
					æ–≤–∏—Ç–∏ –∑–∞–¥–∞–Ω—É –≤–µ–ª–∏—á–∏–Ω—É
					 –∫–≤–∞–Ω—Ç—É —á–∞—Å—É 
     111 0028  E6 40				out 40h,al ; 40h - –∞–¥—Ä–µ—Å–∞
					 8-—Ä–æ–∑—Ä—è–¥–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ —Ç–∞
					–π–º–µ—Ä–∞,  
     112					; —á–µ—Ä–µ–∑ —è–∫–∏–π –∑–∞–¥–∞—
					é—Ç—å –ø–µ—Ä—ñ–æ–¥ —Ç–∞–π–º–µ—Ä–∞  
     113					; —Å–ø–æ—á–∞—Ç–∫—É –º–æ–ª–æ–¥—à
					–∏–π –±–∞–π—Ç, 
     114					; –∞ –ø–æ—Ç—ñ–º —Å—Ç–∞—Ä—à–∏–π 
     115				 
     116 002A  EB 00				jmp $+2 ; —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–
					π –º–µ—Ç–æ–¥ —É–∑–≥–æ–¥–∂–µ–Ω–Ω—è —à–≤–
					∏–¥–∫—ñ—Å–Ω–æ–≥–æ 
     117					 ; –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –∑ –±—ñ–ª
					—å—à –ø–æ–≤—ñ–ª—å–Ω–∏–º –∑–æ–≤–Ω—ñ—à–Ω—
					ñ–º 
     118					 ; –ø—Ä–∏—Å—Ç—Ä–æ—î–º. –ü—Ä–∏–ø
					—É—Å–∫–∞—î–º–æ, —â–æ 
     119					 ; "–±–µ–∑–≥–ª—É–∑–¥–∞" –∫–æ–º–
					∞–Ω–¥–∞ jmp –æ—á–∏—â—É—î –±—É—Ñ–µ—Ä 
     120					 ; –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≤–∏–
					±—ñ—Ä–∫–∏ –∫–æ–º–∞–Ω–¥ —ñ, —Ç–∏–º —Å–∞–
					º–∏–º, 
     121					 ; —É–ø–æ–≤—ñ–ª—å–Ω—é—î —Ä–æ–±–
					æ—Ç—É –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞. –¢–∏–º —á–∞—Å
					–æ–º 
     122					 ; –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –ø—Ä–∏—Å—
					Ç—Ä—ñ–π –±—É–¥–µ –≥–æ—Ç–æ–≤–∏–π  
     123					;–ø—Ä–∏–π–Ω—è—Ç–∏ –Ω–∞—Å—Ç—É–ø–
					Ω–∏–π –±–∞–π—Ç 
     124 002C  90				nop 
     125				 
     126 002D  8A C4				mov al,ah ; (—Å—Ç–∞—Ä—à–∏–π –±–
					∞–π—Ç) 
     127 002F  E6 40				out 40h,al 
     128				 
     129 0031  1F				pop ds 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-5


     130				 
     131 0032  C6 06 0004 R FF			mov int8set,0ffh ; –∑–∞–±–æ—Ä–æ
					–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –≤—Ö–æ–¥–∂–µ–Ω—
					å 
     132 0037				zero_8: 
     133 0037  C3				ret 
     134					 
     135 0038  0002[				int8ptr dw 2 dup (?) 
     136	   ????			
     137			 ]	
     138				
     139 003C				setint8 ENDP 
     140				 
     141				 
     142				;--------------------------------------
					------------------------------------ 
     143				; –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω
					–Ω—è –≤–µ–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–
					Ω—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
     144				;--------------------------------------
					------------------------------------ 
     145 003C				retint8 PROC 
     146				;--------------------------------------
					------------------------------------ 
     147 003C  1E				push ds 
     148 003D  52				push dx 
     149				 
     150 003E  B0 FF				mov al,0ffh ; –≤—ñ–¥–Ω–æ–≤–∏—Ç–
					∏ –Ω–æ—Ä–º–∞–ª—å–Ω—É —Ä–æ–±–æ—Ç—É 
     151 0040  E6 40				out 40h,al ; —Å–∏—Å—Ç–µ–º–Ω–æ–≥
					–æ —Ç–∞–π–º–µ—Ä–∞ 
     152 0042  EB 00				jmp $+2 
     153 0044  90				nop 
     154 0045  E6 40				out 40h,al 
     155 0047  2E: 8B 16 0038 R			mov dx,cs:int8ptr 
     156 004C  2E: 8E 1E 003A R			mov ds,cs:int8ptr+2 
     157				 
     158 0051  B4 25				MOV AH,25H ; –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏
					 –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –≤–µ–∫—Ç–æ—Ä 
     159 0053  B0 08				MOV AL,8 ; –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω
					—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
     160 0055  CD 21				INT 21H ; ds:dx - –≤–∫–∞–∑—ñ–≤–
					Ω–∏–∫ (–ª–æ–≥—ñ—á–Ω–∞ –∞–¥—Ä–µ—Å–∞)  
     161					;–Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤—É (—Å–∏—
					Å—Ç–µ–º–Ω—É) –ø—Ä–æ—Ü–µ–¥—É—Ä—É 
     162					 ; –æ–±—Ä–æ–±. –ø–µ—Ä–µ—Ä–∏–≤–∞
					–Ω–Ω—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
     163 0057  5A				pop dx 
     164 0058  1F				pop ds 
     165 0059  C6 06 0004 R 00			mov int8set,0h ; –¥–æ–∑–≤—ñ–ª –
					Ω–∞—Å—Ç—É–ø–Ω–∏—Ö "–ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω
					—å" 
     166 005E  C3				ret 
     167 005F				retint8 ENDP 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-6


     168				 
     169				 
     170				 
     171				;--------------------------------------
					---------------------- 
     172 005F				setint9 PROC 
     173				;--------------------------------------
					--------------------- 
     174				; –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ "–ø–µ—Ä–µ—Ö–æ–ø–ª–
					µ–Ω–Ω—è" –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ 
					–∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ (int9) 
     175				;--------------------------------------
					---------------------- 
     176 005F  A0 0005 R			mov al,int9set 
     177 0062  0A C0				or al,al 
     178 0064  0F 85 008A R			jnz zero_9 
     179 0068  B4 35				MOV AH,35H ; –æ—Ç—Ä–∏–º–∞—Ç–∏ –
					≤–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è 
     180 006A  B0 09				MOV AL,9 ; –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω
					—è –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ (9) 
     181 006C  CD 21				INT 21H ;–∑–Ω–∞—á–µ–Ω–Ω—è —â–æ 
					–ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è: 
     182					 ; es:bx - –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –
					Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É
					 
     183					 ; –æ–±—Ä–æ–±–∫–∏ –ø–µ—Ä–µ—Ä–∏–
					≤–∞–Ω–Ω—è –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ 
     184				 
     185 006E  2E: 89 1E 008B R			mov cs:int9ptr,bx ; –∑–±–µ—Ä–µ–
					≥—Ç–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç—ñ –∫–æ–¥—ñ–≤ –≤
					–∫–∞–∑—ñ–≤–Ω–∏–∫  
     186 0073  2E: 8C 06 008D R			mov cs:int9ptr+2,es ; –Ω–∞ —Å–∏
					—Å—Ç–µ–º–Ω—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É 
     187				 
     188 0078  BA 00A9 R			mov dx,offset userint9 
     189 007B  1E				push ds 
     190 007C  0E				push cs ; ds:dx - –≤–∫–∞–∑—ñ–≤–
					Ω–∏–∫ –Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∫–æ—Ä–∏—
					Å—Ç—É–≤–∞—á–∞ 
     191 007D  1F				pop ds ; –æ–±—Ä–æ–±. –ø–µ—Ä–µ—Ä
					–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–
					∏ 
     192				 
     193 007E  B4 25				MOV AH,25H ; –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç
					–∏ –≤–µ–∫—Ç–æ—Ä "–ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω
					—è" 
     194 0080  B0 09				MOV AL,9 ; –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω
					—è –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ (9) 
     195 0082  CD 21				INT 21H ;  
     196 0084  1F				pop ds 
     197				 
     198 0085  C6 06 0005 R FF			mov int9set,0ffh ; –∑–∞–±–æ—Ä–æ
					–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –≤—Ö–æ–¥–∂–µ–Ω—
					å 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-7


     199				 
     200 008A				zero_9: 
     201 008A  C3				ret 
     202 008B  0002[				int9ptr dw 2 dup (?) 
     203	   ????			
     204			 ]	
     205				
     206 008F				setint9 ENDP 
     207				 
     208				 
     209				;--------------------------------------
					------------------------------------ 
     210				; –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω
					–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ (—Å–∏—Å—Ç
					–µ–º–Ω–æ–≥–æ) 
     211				; –≤–µ–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è
					 –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ 
     212				;--------------------------------------
					------------------------------------ 
     213 008F				retint9 PROC 
     214 008F  1E				push ds 
     215 0090  52				push dx 
     216 0091  2E: 8B 16 008B R			mov dx,cs:int9ptr ; ds:dx - –ø–
					æ–∫–∞–∂—á–∏–∫ –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤—É (
					—Å–∏—Å—Ç–µ–º–Ω—É) 
     217 0096  2E: 8E 1E 008D R			mov ds,cs:int9ptr+2 ; –ø—Ä–æ—Ü–
					µ–¥—É—Ä—É –æ–±—Ä–æ–±–∫–∏ –ø–µ—Ä–µ—Ä–∏–≤
					–∞–Ω–Ω—è –≤—ñ–¥ 
     218					; –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ 
     219				 
     220 009B  B4 25				MOV AH,25H ; –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç
					–∏ –≤–µ–∫—Ç–æ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ—ó –ø—Ä
					–æ—Ü–µ–¥—É—Ä–∏ 
     221 009D  B0 09				MOV AL,9 ; –æ–±—Ä–æ–±–∫–∏ –ø–µ—
					Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç
					—É—Ä–∏ 
     222 009F  CD 21				INT 21H ;  
     223					 ;  
     224 00A1  5A				pop dx 
     225 00A2  1F				pop ds 
     226 00A3  C6 06 0005 R 00			mov int9set,0h ; –¥–æ–∑–≤—ñ–ª –
					Ω–∞—Å—Ç—É–ø–Ω–∏—Ö "–ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω
					—å" 
     227 00A8  C3				ret 
     228 00A9				retint9 ENDP 
     229				 
     230				 
     231				;--------------------------------------
					---------------------------------------
					------------------ 
     232				; –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—Ä–æ–±–∫–∏ –ø–
					µ—Ä–µ—Ä–∏–≤–∞–Ω—å –≤—ñ–¥ –∫–ª–∞–≤—ñ–∞—Ç
					—É—Ä–∏, 
     233				; –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –ª—é–
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-8


					±–æ–º—É –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∞–±–æ –≤—
					ñ–¥—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–ª–∞–≤—ñ—à –∫–ª–∞
					–≤—ñ–∞—Ç—É—Ä–∏,
     234				; –∑–¥—ñ–π—Å–Ω—é—î –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è
					 –≤ MS-DOS –ø—ñ—Å–ª—è –≤—ñ–¥—Ç–∏—Å–∫–∞–
					Ω–Ω—è –∫–ª–∞–≤—ñ—à—ñ Esc 
     235				;--------------------------------------
					---------------------------------------
					------------------- 
     236 00A9				userint9 proc far 
     237				;--------------------------------------
					-------------------------------------- 
     238 = 0001				esc_key equ 01h ; —Å–∫–∞–Ω-–∫–æ–¥ –∫–ª–
					∞–≤—ñ—à—ñ esc 
     239 00A9  60				pusha 
     240 00AA  06				push es 
     241 00AB  E4 60				in al,60h ; –≤–≤–µ—Å—Ç–∏ —Å–∫–∞
					–Ω-–∫–æ–¥ - —Ä–æ–∑—Ä—è–¥–∏ 0-6 
     242 00AD  8A E0				mov ah,al ; 7-–∏–π —Ä–æ–∑—Ä—è–¥
					 –¥–æ—Ä—ñ–≤–Ω—é—î 0 –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫
					–∞–Ω–Ω—ñ 
     243 00AF  24 7F				and al,7fh ;–∫–ª–∞–≤—ñ—à—ñ, 1- 
					–ø—Ä–∏ –≤—ñ–¥—Ç–∏—Å–∫–∞–Ω–Ω—ñ 
     244				 
     245					; cmp al,esc_key 
     246					; je ui9010 
     247					 
     248					; ; (–≤–∞—Ä—ñ–∞–Ω—Ç 2) 
     249					; pop es 
     250					; popa 
     251					; jmp dword ptr cs:int9ptr ; –ø
					–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—É 
     252					; ;–ø—Ä–æ—Ü–µ–¥—É—Ä—É –æ–±—Ä–æ–
					±–∫–∏ 
     253					; ;–ø–µ—Ä–µ—Ä–∏–≤–∞–Ω—å –≤—ñ–¥ 
					–∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏, —è–∫–∞ 
     254					; ;–≤–∏–∫–æ–Ω–∞—î –≤—Å—ñ –Ω–µ–æ
					–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó, –≤–∫–ª—é—á–∞—é—á–∏
					 
     255					; ;–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤ –ø–µ
					—Ä–µ—Ä–≤–∞–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É 
     256				 
     257 00B1  E8 01ED R			call checkKeys 
     258				 
     259 00B4					ui9010: 
     260 00B4  8B D8				mov bx,ax 
     261 00B6  E4 61				in al,61h ;–±—ñ—Ç 7 –ø–æ—Ä—Ç–∞ 
					61h –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–≤–
					µ–¥–µ–Ω–Ω—è 
     262					; ; –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—á–æ–
					≥–æ —ñ–º–ø—É–ª—å—Å—É –≤ –∫–ª–∞–≤—ñ–∞—Ç—
					É—Ä—É –ü–ï–û–ú. 
     263					 ; –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –±–ª–æ–
					∫—É—î—Ç—å—Å—è –ø–æ–∫–∏ –Ω–µ –Ω–∞–¥—ñ–π–
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-9


					¥–µ 
     264					 ; –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—á–∏–π
					 —ñ–º–ø—É–ª—å—Å 
     265					 ; 
     266 00B8  8A E0				mov ah,al 
     267 00BA  0C 80				or al,80h ; | 
     268 00BC  E6 61				out 61h,al ; –≤–∏–≤–µ–¥–µ–Ω–Ω—è
					 –Ω–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É ‚îî‚îÄ‚îÄ‚îÄ
					‚îê  
     269 00BE  EB 00				jmp $+2 
     270 00C0  8A C4				mov al,ah 
     271 00C2  E6 61				out 61h,al ; –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂
					—É—é—á–æ–≥–æ —ñ–º–ø—É–ª—å—Å—É ‚îå‚îÄ‚îÄ
					‚îÄ‚îò 
     272				 
     273 00C4  B0 20				mov al,20h ; —Ä–æ–∑–±–ª–æ–∫—É–≤
					–∞—Ç–∏ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ –ø–µ—Ä–µ
					—Ä–∏–≤–∞–Ω–Ω—è 
     274					 ; –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–∞–
					ø–∏—Ç—ñ–≤ –Ω–∞ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è  
     275					;–ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ç–∞ –º–µ–Ω
					—à–æ–≥–æ —Ä—ñ–≤–Ω—ñ–≤ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—
					Ç—É, 
     276 00C6  E6 20				out 20h,al ; —â–æ –∑–∞–±–µ–∑–ø–
					µ—á–∏—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–∞—Å—Ç
					—É–ø–Ω–æ–≥–æ  
     277					;–ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ 
					–∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ 
     278				 
     279 00C8  8B C3				mov ax,bx 
     280 00CA  3A E0				cmp ah,al ; –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ 
					–ø–æ–¥—ñ—ó –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è - –≤—
					ñ–¥ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è 
     281					 ; —á–∏ –≤—ñ–¥ –≤—ñ–¥—Ç–∏—Å–∫–∞
					–Ω–Ω—è –∫–ª–∞–≤—ñ—à—ñ –∫–ª–∞–≤—ñ–∞—Ç—É—
					Ä–∏ 
     282 00CC  0F 84 00F0 R			je ui9040 
     283					 ;–≤—ñ–¥—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–ª–∞
					–≤—ñ—à—ñ 
     284				 
     285 00D0					ui9020: 
     286					 
     287 00D0  3C 01				cmp al, esc_key 
     288 00D2  0F 85 00F0 R			jne ui9040 
     289				 
     290 00D6  06				push es 
     291 00D7  C4 1E 0000 R			les bx, @ms_dos_busy ; es:bx - 
					–∞–¥—Ä–µ—Å–∞ –æ–∑–Ω–∞–∫–∏  
     292					;–∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ MS-DOS 
     293 00DB  26: 8A 07			mov al,es:[bx] ; ax - –æ–∑–Ω–∞–
					∫–∞ –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ MS-DOS 
     294 00DE  07				pop es 
     295 00DF  0A C0				or al,al ; –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ 
     296					; —è–∫—â–æ –±—É–ª–∞ –ø–µ—Ä–µ—Ä–
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-10


					≤–∞–Ω–∞ —Ä–æ–±–æ—Ç–∞ MS-DOS 
     297					;–≤ "–Ω–µ–≤–¥–∞–ª–∏–π" –º–æ–º–µ
					–Ω—Ç 
     298 00E1  0F 85 00F0 R			jnz ui9040 ; —Ç–æ –Ω–µ –º–æ–∂–Ω
					–∞ –≤—ñ–¥ –Ω–µ—ó –≤–∏–º–∞–≥–∞—Ç–∏ 
     299					 ; –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä—è–¥—É 
					—Ñ—É–Ω–∫—Ü—ñ–π 
     300					; (–≤ –∑–∞–≥–∞–ª—å–Ω–æ–º—É –≤–∏
					–ø–∞–¥–∫—É MS-DOS  
     301					; –Ω–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –ø–
					æ–≤—Ç–æ—Ä–Ω–µ –≤—Ö–æ–¥–∂–µ–Ω–Ω—è) 
     302				 
     303 00E5  E8 003C R			call retint8 
     304 00E8  E8 008F R			call retint9 
     305				 
     306 00EB  B8 4C00				mov ax,4c00h 
     307 00EE  CD 21				int 21h ; –ó–ê–ö–Ü–ù–ß–ò–¢–ò –†
					–û–ë–û–¢–£ 
     308					; –ë–ê–ì–ê–¢–û–ü–†–û–ì–†–ê–ú–ù–
					û–á –ú–û–î–ï–õ–Ü 
     309 00F0				ui9040: 
     310 00F0  07				pop es ; –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —Å—
					Ç–µ–∫ –ø–µ—Ä–µ—Ä–≤–∞–Ω–æ—ó –ø—Ä–æ–≥—Ä–∞
					–º–∏ 
     311 00F1  61				popa 
     312 00F2  CF				iret ; –∑–∞–∫—ñ–Ω—á–∏—Ç–∏ –æ–±—
					Ä–æ–±–∫—É –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è 
     313 00F3				userint9 endp 
     314				;--------------------------------------
					---------------------- 
     315				; –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—Ä–æ–±–∫–∏ –ø–
					µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä
					–∞ 
     316				; (–º–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–∞–Ω—Ç—ñ–≤) 
     317				; –∫–æ–¥–∏ —Å—Ç–∞–Ω—É –∑–∞–¥–∞—á (–≤–∏–
					∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –º–∞—Å–∏
					–≤—ñ init) 
     318 = 0000				ready equ 0 ; –∑–∞–¥–∞—á–∞ –∑–∞–≤–∞–Ω—Ç
					–∞–∂–µ–Ω–∞ –≤ –ø–∞–º‚Äô—è—Ç—å —ñ 
     319				 ; –≥–æ—Ç–æ–≤–∞ –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ
					–≥–æ –∑–∞–ø—É—Å–∫—É 
     320				 ; —Å—Ç–∞—Ç—É—Å –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—
					å—Å—è –ø–æ–∑–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∫–
					≤–∞–Ω—Ç—ñ–≤ 
     321 = 0001				execute equ 1 ; –∑–∞–¥–∞—á–∞ –≤–∏–∫–æ–Ω
					—É—î—Ç—å—Å—è 
     322 = 0002				hesitation equ 2 ; –∑–∞–¥–∞—á–∞ –ø—Ä–∏–
					∑—É–ø–∏–Ω–µ–Ω–∞ —ñ —á–µ–∫–∞—î —Å–≤–æ—î—
					ó —á–µ—Ä–≥–∏ 
     323 = 0004				close equ 4 ; –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–¥
					–∞—á—ñ –∑–∞–≤–µ—Ä—à–µ–Ω–æ 
     324 = 0008				stop equ 8 ; –∑–∞–¥–∞—á–∞ –∑—É–ø–∏–Ω–µ–
					Ω–∞  
     325				 ; —Å—Ç–∞—Ç—É—Å –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-11


					å—Å—è —ñ –∑–º—ñ–Ω—é—î—Ç—å—Å—è 
     326				 ; –ø–æ–∑–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–≤–∞–Ω
					—Ç—ñ–≤ 
     327 = 0010				absent equ 16 ; –∑–∞–¥–∞—á–∞ –≤—ñ–¥—Å—É
					—Ç–Ω—è  
     328				 
     329				;--------------------------------------
					---------------------- 
     330				; –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—Ä–æ–±–∫–∏ –ø–
					µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥ —Ç–∞–π–º–µ—Ä
					–∞ 
     331				;  (–º–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–∞–Ω—Ç—ñ–≤) 
     332				; –∫–æ–¥–∏ —Å—Ç–∞–Ω—É –∑–∞–¥–∞—á (–≤–∏–
					∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –º–∞—Å–∏
					–≤—ñ init) 
     333 = 0000				ready equ 0 ; –∑–∞–¥–∞—á–∞ –∑–∞–≤–∞–Ω—Ç
					–∞–∂–µ–Ω–∞ –≤ –ø–∞–º‚Äô—è—Ç—å —ñ 
     334				     ; –≥–æ—Ç–æ–≤–∞ –¥–æ –ø–æ—á–∞—Ç–∫–æ
					–≤–æ–≥–æ –∑–∞–ø—É—Å–∫—É 
     335				     ; —Å—Ç–∞—Ç—É—Å –≤—Å—Ç–∞–Ω–æ–≤–ª—é—
					î—Ç—å—Å—è –ø–æ–∑–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
					 –∫–≤–∞–Ω—Ç—ñ–≤ 
     336 = 0001				execute equ 1 ; –∑–∞–¥–∞—á–∞ –≤–∏–∫–æ–Ω
					—É—î—Ç—å—Å—è 
     337 = 0002				hesitation equ 2 ; –∑–∞–¥–∞—á–∞ –ø—Ä–∏–
					∑—É–ø–∏–Ω–µ–Ω–∞ —ñ —á–µ–∫–∞—î —Å–≤–æ—î—
					ó —á–µ—Ä–≥–∏ 
     338 = 0004				close  equ 4 ; –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–
					¥–∞—á—ñ –∑–∞–≤–µ—Ä—à–µ–Ω–æ 
     339 = 0008				stop  equ 8 ; –∑–∞–¥–∞—á–∞ –∑—É–ø–∏–Ω–µ
					–Ω–∞  
     340				     ; —Å—Ç–∞—Ç—É—Å –≤—Å—Ç–∞–Ω–æ–≤–ª—é—
					î—Ç—å—Å—è —ñ –∑–º—ñ–Ω—é—î—Ç—å—Å—è 
     341				      ; –ø–æ–∑–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–
					≤–∞–Ω—Ç—ñ–≤ 
     342 = 0010				absent equ 16 ; –∑–∞–¥–∞—á–∞ –≤—ñ–¥—Å—É
					—Ç–Ω—è  
     343				 
     344				 
     345					;------------------------------
					------------------------------ 
     346 00F3				userint8 PROC far 
     347					;------------------------------
					------------------------------ 
     348 00F3  66| 60				pushad   ;–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è 
					–†–û–ù –≤ —Å—Ç–µ–∫—É –ø–µ—Ä–µ—Ä–≤–∞–Ω–æ
					—ó –∑–∞–¥–∞—á—ñ 
     349 00F5  1E				push ds 
     350				 
     351					; (–≤–∞—Ä—ñ–∞–Ω—Ç 3) 
     352 00F6  9C				pushf   ;–ø—Ä–æ–≥—Ä–∞–º–Ω–∞ —ñ–
					º—ñ—Ç–∞—Ü—ñ—è –∞–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –ø–µ
					—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è 
     353					;–í–Ü–î–ú–Ü–¢–ò–ú–û - –æ–∑–Ω–∞–
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-12


					∫–∞ –¥–æ–∑–≤–æ–ª—É –Ω–∞ –ø–µ—Ä–µ—Ä–∏–≤–
					∞–Ω–Ω—è (if) –∞–ø–∞—Ä–∞—Ç—É—Ä–æ—é —Å–∫–
					∏–Ω—É—Ç–∞ –≤ 0. 
     354				 
     355 00F7  2E: FF 1E 0038 R			call cs:dword ptr int8ptr 
     356					;–≤–∏–∫–ª–∏–∫ —Å–∏—Å—Ç–µ–º–Ω–æ—
					ó –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ –æ–±—Ä–æ–±–∫–∏ –ø–
					µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è int8, 
     357					;—è–∫–∞, –º—ñ–∂ —ñ–Ω—à–∏–º, —Ä–
					æ–∑–±–ª–æ–∫—É—î 8-–º–µ –ø–µ—Ä–µ—Ä–∏–≤–∞
					–Ω–Ω—è –≤ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ –ø–µ—Ä–µ
					—Ä–∏–≤–∞–Ω—å  
     358					;–∞–ª–µ –∞–ø–∞—Ä–∞—Ç–Ω—ñ –ø–µ—Ä
					–µ—Ä–∏–≤–∞–Ω–Ω—è –Ω–µ –º–æ–∂–ª–∏–≤—ñ, –
					æ—Å–∫—ñ–ª—å–∫–∏ if=0 
     359				 
     360				 
     361 00FC  B8 ---- R			mov ax,_data ;–≤ –ø–µ—Ä–µ—Ä–≤–∞
					–Ω—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ –≤–º—ñ—Å—Ç —Å–µ
					–≥–º–µ–Ω—Ç–Ω–æ–≥–æ —Ä–µ–≥—ñ—Å—Ç—Ä–∞ 
     362 00FF  8E D8				mov ds,ax		;ds –≤ 
					–∑–∞–≥–∞–ª—å–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–
					æ–∂–µ –±—É—Ç–∏ –ª—é–±–∏–º 
     363				 
     364 0101  FF 06 009C R			inc clk  ; –ø—Ä–æ–≥—Ä–∞–º–Ω–∏–π
					 –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω—
					å –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ 
     365 0105  FF 36 009C R			push clk  ; –º–æ–∂–µ –±—É—Ç–∏ –
					∫–æ—Ä–∏—Å–Ω–∏–º –ø—Ä–∏ –≤–∏–≤—á–µ–Ω–Ω—ñ
					 –º–æ–¥–µ–ª—ñ 
     366 0109  68 0988				push 2440 
     367 010C  E8 0298 R			call show		; –≤–∏–
					≤–µ–¥–µ–Ω–Ω—è –Ω–∞ –µ–∫—Ä–∞–Ω –∑–Ω–∞—á–
					µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ 
     368				 
     369 010F  66| 33 F6			xor esi,esi 
     370 0112  8B 36 002A R			mov si,nprg 
     371 0116  83 FE 0A				cmp si,fon  ; –ø–µ—Ä–µ—Ä–≤–∞–Ω–
					∞ –∑–∞–¥–∞—á–∞ —Ñ–æ–Ω–æ–≤–∞ ? 
     372 0119  0F 84 012E R			je disp005 
     373				 
     374					; –ø–µ—Ä–µ—Ä–≤–∞–Ω–∞ –∑–∞–¥–∞—á
					–∞ –Ω–µ —Ñ–æ–Ω–æ–≤–∞ 
     375 011D  80 BC 004C R 01			cmp clockt[si],1 ; —î —â–µ –Ω–µ
					 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∫–≤–∞–Ω—Ç–∏ ? 
     376 0122  0F 82 013E R			jc disp010 
     377				 
     378 0126  FE 8C 004C R			dec clockt[si] ; –∑–º–µ–Ω—à–∏—Ç
					–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –∫–≤–∞–Ω—Ç—ñ–≤ 
     379 012A  1F				pop ds 
     380 012B  66| 61				popad  ; –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –
					≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ—Ä–µ—Ä–≤–∞–Ω–æ—ó 
					–∑–∞–¥–∞—á—ñ 
     381 012D  CF				iret 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-13


     382				 
     383 012E				disp005:    ; –ø–µ—Ä–µ—Ä–≤–∞–Ω–∞ –∑–∞–¥
					–∞—á–∞ —Ñ–æ–Ω–æ–≤–∞ 
     384 012E  89 26 0006 R			mov fonsp,sp 
     385 0132  C7 06 002A R 0009		mov nprg,max_prg-1 ; –∑–∞–±–µ–∑
					–ø–µ—á–∏—Ç–∏ –ø–µ—Ä–µ–≥–ª—è–¥ –∑–∞–¥–∞—
					á –∑ 0-–≤–æ—ó 
     386 0138  B9 000A				mov cx,max_prg  ; max_prg - max
					 –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–¥–∞—á 
     387 013B  EB 11 90				jmp disp015 
     388				 
     389 013E				disp010:      ; –ø–µ—Ä–µ—Ä–≤–∞–Ω–∞ –∑–∞
					–¥–∞—á–∞ –Ω–µ —Ñ–æ–Ω–æ–≤–∞ 
     390 013E  67| 89 2475 0000000A		mov stp[esi*2],sp  
     391	R			
     392 0146  C6 84 002C R 02			mov init[si],hesitation ; –ø—Ä–
					∏–∑—É–ø–∏–Ω–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –∑–∞–¥
					–∞—á—É 
     393 014B  B9 000A				mov cx,max_prg 
     394				 
     395				 
     396 014E				disp015: 
     397					; –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–¥–∞
					—á—ñ, —è–∫—ñ–π –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—
					Ä–µ–¥–∞—Ç–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è 
     398 014E  BF 000B				mov di,max_prg+1 
     399 0151  2B F9				sub di,cx 
     400 0153  03 3E 002A R			add di,nprg 
     401 0157  83 FF 0A				cmp di,max_prg 
     402 015A  0F 82 0161 R			jc disp018 
     403 015E  83 EF 0A				sub di,max_prg 
     404 0161				disp018: 
     405 0161  66| 33 DB			xor ebx,ebx 
     406 0164  8B DF				mov bx,di 
     407					;push bx 
     408					;push 3220 
     409					;call show 
     410				 
     411					; —Å—Ö –ø—Ä–æ–±—ñ–≥–∞—î –∑–Ω–∞—
					á–µ–Ω–Ω—è max_prg,max_prg-1,...,2,1 
     412					; bx –ø—Ä–æ–±—ñ–≥–∞—î –∑–Ω–∞—á–
					µ–Ω–Ω—è nprg+1,nprg+2,...,max_prg-  
     413					;1,0,...,nprg 
     414					; 
     415 0166  80 BF 002C R 00			cmp init[bx],ready 
     416 016B  0F 84 01A5 R			je disp100   ; –ø–µ—Ä–µ—Ö—ñ–¥ –
					Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø—É—Å–∫ –
					∑–∞–¥–∞—á—ñ 
     417				 
     418 016F  80 BF 002C R 02			cmp init[bx],hesitation 
     419 0174  0F 84 0188 R			je  disp020   ; –ø–µ—Ä–µ—Ö—ñ–¥ 
					–Ω–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–
					∏ 
     420					; –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –∑–∞–¥–∞—á
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-14


					—ñ 
     421 0178  E2 D4				loop disp015 
     422				 
     423					; –≤—ñ–¥—Å—É—Ç–Ω—ñ –∑–∞–¥–∞—á—ñ
					, —è–∫—ñ –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å 
     424					; (–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏),
					 —Ç–æ–º—É  
     425					;  
     426 017A  8B 26 0006 R			mov sp,fonsp		
						; —É—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Å—Ç
					–µ–∫ —Ñ–æ–Ω–æ–≤–æ—ó –∑–∞–¥–∞—á—ñ 
     427 017E  C7 06 002A R 000A		mov nprg,fon 
     428 0184  1F				pop ds			; —ñ–∑ 
					—Å—Ç–µ–∫–∞ —Ñ–æ–Ω–æ–≤–æ—ó –∑–∞–¥–∞—á—ñ 
					–≤—ñ–¥–Ω–æ–≤–ª—é—î–º–æ 
     429 0185  66| 61				popad			
							; –≤–º—ñ—Å—Ç —Ä–µ–≥—ñ—Å
					—Ç—Ä—ñ–≤ 
     430 0187  CF				iret    ; –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è 
					–≤ —Ñ–æ–Ω–æ–≤—É –∑–∞–¥–∞—á—É 
     431				 
     432				 
     433 0188				disp020: 
     434					; –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–±
					–æ—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –∑–∞–¥–∞—á—ñ 
     435					;push bx 
     436					;push 2480 
     437					;call show 
     438 0188  89 1E 002A R			mov nprg,bx 
     439 018C  67| 8B 245D 0000000A		mov sp,stp[ebx*2] 
     440	R			
     441 0194  8A 87 003C R			mov al,clock[bx] 
     442 0198  88 87 004C R			mov clockt[bx],al ; –≤—Å—Ç–∞–Ω–
					æ–≤–∏—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—É 
     443					; –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∞–Ω—Ç
					—ñ–≤ 
     444 019C  C6 87 002C R 01			mov init[bx],execute	
						; —Å—Ç–∞–Ω –∑–∞–¥–∞—á—ñ - –∑–∞–
					¥–∞—á–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è 
     445				 
     446 01A1  1F				pop ds 
     447 01A2  66| 61				popad 
     448 01A4  CF				iret 
     449				 
     450 01A5				disp100: 
     451					; –ø–µ—Ä—à–æ–ø–æ—á–∞—Ç–∫–æ–≤–∏–
					π –∑–∞–ø—É—Å–∫ –∑–∞–¥–∞—á—ñ 
     452 01A5  89 1E 002A R			mov nprg,bx 
     453 01A9  67| 8B 245D 0000000A		mov sp,stp[ebx*2] 
     454	R			
     455 01B1  8A 87 003C R			mov al,clock[bx] 
     456 01B5  88 87 004C R			mov clockt[bx],al  ; –≤—Å—Ç–∞–Ω
					–æ–≤–∏—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—É 
     457					; –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∞–Ω—Ç
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-15


					—ñ–≤ 
     458 01B9  C6 87 002C R 01			mov init[bx],execute 
     459				 
     460 01BE  67| FF 345D 0000007C		push	names[ebx*2]	
						; —ñ–º'—è –∑–∞–¥–∞—á—ñ 
     461	R			
     462 01C6  67| FF 345D 0000005C		push screen_addr[ebx*2] ; –∞–¥—
					Ä–µ—Å–∞ "–≤—ñ–∫–Ω–∞" –¥–ª—è –∑–∞–¥–∞—á—
					ñ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ  
     463	R			
     464 01CE  6A 16				push 22    ; —Ä–æ–∑—Ä—è–¥–Ω—ñ—Å
					—Ç—å –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ 
     465 01D0  E8 021F R			call Vcount   ; –∑–∞–ø—É—Å–∫ 
     466				 
     467				 
     468 01D3  66| 33 F6			xor esi,esi 
     469 01D6  8B 36 002A R			mov si,nprg   ; –Ω–∞ ax - –Ω–æ–
					º–µ—Ä –∑–∞–¥–∞—á—ñ, —è–∫–∞ 
     470					; –∑–∞–≤–µ—Ä—à–∏–ª–∞ —Å–≤–æ—é —
					Ä–æ–±–æ—Ç—É –≤ –º–µ–∂–∞—Ö 
     471					; —á–µ—Ä–≥–æ–≤–æ–≥–æ –∫–≤–∞–Ω—Ç
					—É —á–∞—Å—É 
     472 01DA  C6 84 002C R 04			mov init[si],close 
     473 01DF  8B 26 0006 R			mov sp,fonsp 
     474 01E3  C7 06 002A R 000A		mov nprg,fon 
     475 01E9  1F				pop ds 
     476 01EA  66| 61				popad 
     477 01EC  CF				iret     ; –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è
					 –≤ —Ñ–æ–Ω–æ–≤—É –∑–∞–¥–∞—á—É 
     478				 
     479 01ED					userint8 ENDP 
     480				 
     481				 
     482 01ED				checkKeys proc 
     483 01ED  60				pusha 
     484 01EE  06				push es 
     485 01EF  1E				push ds 
     486				 
     487 01F0  3C 3D				cmp al, 3Dh 
     488 01F2  0F 85 021B R			jne checkKeysEnd 
     489				 
     490 01F6  BB ---- R			mov bx, _DATA 
     491 01F9  8E DB				mov ds, bx 
     492				 
     493 01FB  BF 0000				mov di, 0 
     494				 
     495 01FE  80 FC 3D				cmp ah, 3Dh 
     496 0201  0F 84 0206 R			je label101 
     497 0205  47				inc di 
     498 0206					label101: 
     499				 
     500 0206					tasksLoop: 
     501				 
     502 0206  80 BD 002C R 10			cmp BYTE PTR init[di], absent 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-16


     503 020B  0F 85 0214 R			jne nextElement 
     504				 
     505 020F  C6 85 002C R 00			mov BYTE PTR init[di], ready 
     506				 
     507 0214					nextElement: 
     508				 
     509 0214  47				inc di 
     510 0215  47				inc di 
     511 0216  83 FF 0A				cmp di, max_prg 
     512 0219  7C EB				jl tasksLoop 
     513				 
     514 021B					checkKeysEnd: 
     515				 
     516 021B  1F				pop ds 
     517 021C  07				pop es 
     518 021D  61				popa 
     519				 
     520 021E  C3				ret 
     521 021F				checkKeys endp 
     522				 
     523				 
     524				 
     525				;- 
     526				; Vcount - –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–ª—è –º
					–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –Ω–µ–∑–∞–ª–µ–∂–Ω–∏
					—Ö –∑–∞–¥–∞—á  
     527				; –≤—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏: 
     528				; 1-–π - —ñ–º'—è –∑–∞–¥–∞—á—ñ (–¥–≤–∞ —
					Å–∏–º–≤–æ–ª–∞) [bp+8] 
     529				; 2-–π - –∑–º—ñ—â–µ–Ω–Ω—è –≤ –≤—ñ–¥–µ–æ
					—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ "–≤—ñ–∫–Ω–∞" –∑–∞–¥–∞—
					á—ñ [bp+6] 
     530				; 3-–π - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–≤—ñ–π–∫–
					æ–≤–∏—Ö —Ä–æ–∑—Ä—è–¥—ñ–≤ –ª—ñ—á–∏–ª—å–Ω
					–∏–∫–∞ [bp+4] 
     531				; –í–∏–∫–æ–Ω—É–≤–∞–Ω—ñ –¥—ñ—ó: 
     532				; –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É: 
     533				; - –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω
					–Ω—è 
     534				; - —Å—Ç–≤–æ—Ä—é—î –≤ —Å—Ç–µ–∫—É 10-–±–
					∞–π—Ç–Ω—É –æ–±–ª–∞—Å—Ç—å –¥–ª—è –ª–æ–∫–
					∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö 
     535				; - —Ä–æ–∑–º—ñ—â—É—î –≤ —Ü—é –æ–±–ª–∞—Å
					—Ç—å –ø–æ –∞–¥—Ä–µ—Å—ñ [bp-2] —Å—Ç–∞—Ç–
					æ–∫ –≤—ñ–¥ –¥—ñ–ª–µ–Ω–Ω—è 
     536				; 3-–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ 32 (—Ñ
					–∞–∫—Ç–∏—á–Ω–∞ —Ä–æ–∑—Ä—è–¥–Ω—ñ—Å—Ç—å –
					ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ - 
     537				; –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –≤—ñ–¥ –ø–
					æ–º–∏–ª–æ–∫ –≤ –∑–∞–≤–¥–∞–Ω–Ω—ñ —Ä–æ–∑—
					Ä—è–¥–Ω–æ—Å—Ç—ñ) 
     538				; - –∑–∞–ø–∏—Å—É—î –≤ —Ü—é –æ–±–ª–∞—Å—Ç
					—å –ø–æ –∞–¥—Ä–µ—Å—É [bp-6] –º–∞—Å–∫—É 
					–∑ —á–∏—Å–ª–æ–º 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-17


     539				; –æ–¥–∏–Ω–∏—Ü—å –≤ –º–æ–ª–æ–¥—à–∏—Ö —Ä
					–æ–∑—Ä—è–¥—ñ–≤ —Ä—ñ–≤–Ω–∏–º —Ñ–∞–∫—Ç–∏—
					á–Ω—ñ–π  
     540				; —Ä–æ–∑—Ä—è–¥–Ω–æ—Å—Ç—ñ –ª—ñ—á–∏–ª—å–Ω
					–∏–∫–∞ 
     541				; - –∑–∞–ø–∏—Å—É—î –≤ –Ω—É–ª—å –≤ 4-—Ö 
					–±–∞–π—Ç –Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø–æ
					 –∞–¥—Ä–µ—Å—É [bp-10] 
     542				 
     543				; –≤ –ø–æ–¥–∞–ª—å—à–æ–º—É –≤ —Ü–∏–∫–ª—ñ
					: 
     544				; - –≤–∏–≤–æ–¥–∏—Ç—å –ø–æ–∫–∞–∑–Ω–∏–∫–∏
					 –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –Ω–∞ –µ–∫—Ä–∞–Ω 
     545				; - –∑–±—ñ–ª—å—à—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –
					ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –Ω–∞ 1 
     546				; –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–∞–¥–∞—á—ñ –ø—
					ñ—Å–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –ª—ñ—á–∏–ª—å–Ω
					–∏–∫–∞  
     547				; –∑ —Å—Ç–∞–Ω—É "–≤—Å—ñ –æ–¥–∏–Ω–∏—Ü—ñ"
					 –≤ —Å—Ç–∞–Ω –≤—Å—ñ 0 
     548				 
     549 021F				Vcount proc near 
     550					 
     551 021F  55				push bp 
     552 0220  8B EC				mov bp,sp 
     553 0222  83 EC 0A				sub sp,10 ;—Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è
					 –≤ —Å—Ç–µ–∫—É –æ–±–ª–∞—Å—Ç—ñ –¥–ª—è 
     554					 ;–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏
					—Ö 
     555 0225  FB				sti 
     556				 
     557 0226  06				push es 
     558 0227  B8 B800				mov ax,0b800h 
     559 022A  8E C0				mov es,ax 
     560				 
     561 022C  8B 46 04				mov ax,[bp+4] ;ax = –∫—ñ–ª—å–∫—
					ñ—Å—Ç—å —Ä–æ–∑—Ä—è–¥—ñ–≤ –ª—ñ—á–∏–ª—å–Ω
					–∏–∫–∞ 
     562 022F  25 001F				and ax,31 ;ax=ax mod 32 (–¥–ª—è
					 –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∫–∏) 
     563 0232  89 46 FE				mov [bp-2],ax ;–ø–æ [bp-2] –∫—ñ
					–ª—å–∫—ñ—Å—Ç—å —Ä–æ–∑—Ä. –ª—ñ—á–∏–ª—å–Ω
					–∏–∫–∞  
     564					 ;<32 
     565 0235  8B C8				mov cx,ax 
     566 0237  66| B8 00000001			mov eax,001b 
     567 023D  66| D3 E0			shl eax,cl 
     568 0240  66| 48				dec eax ; eax - –º–∞—Å–∫–∞ —Å —
					á–∏—Å–ª–æ–º 1 —Ä—ñ–≤–Ω–∏–º 
     569					 ; –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ä–æ–∑—Ä—
					è–¥—ñ–≤ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ 
     570 0242  66| 89 46 FA			mov [bp-6],eax 
     571				 
     572 0246  66| C7 46 F6 00000000		mov dword ptr [bp-10],0 ; —Å–∫–
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-18


					∏–¥–∞–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ 
     573				 
     574 024E  8B 7E 06				mov di,[bp+6] ; –≤–∏–≤—ñ–¥ —ñ–º
					–µ–Ω—ñ –∑–∞–¥–∞—á—ñ 
     575 0251  8B 56 08				mov dx,[bp+8] 
     576				 
     577 0254  8A C6				mov al, dh 
     578 0256  FC				cld 
     579 0257  AA				stosb 
     580 0258  47				inc di 
     581 0259  8A C2				mov al,dl 
     582 025B  AA				stosb 
     583 025C  47				inc di 
     584				 
     585 025D  FD				std ;–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ 
					–≤–∏–≤–æ–¥—É –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ 
     586 025E  03 F9				add di,cx ;–ø–æ—á–∏–Ω–∞—é—á–∏ —
					Å –º–æ–ª–æ–¥—à–∏—Ö —Ä–æ–∑—Ä—è–¥—ñ–≤ 
     587 0260  03 F9				add di,cx 
     588 0262  8B DF				mov bx,di 
     589 0264  66| 33 D2			xor edx,edx 
     590				 
     591 0267				l20: ;–≤–∏–≤—ñ–¥ –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –
					ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –≤ –¥–≤–æ—ó—á–Ω–æ–º
					—É  
     592					 ;—Ñ–æ—Ä–º–∞—Ç—ñ 
     593 0267  8B FB				mov di,bx 
     594 0269  8B 4E FE				mov cx,[bp-2] 
     595				 
     596 026C				l40: 
     597 026C  B0 30				mov al, '0' 
     598 026E  66| D1 EA			shr edx, 1 
     599 0271  0F 83 0277 R			jnc l60 
     600 0275  FE C0					inc al 
     601 0277					l60: 
     602 0277  AA				stosb 
     603 0278  4F				dec di 
     604 0279  E2 F1				loop l40 
     605				 
     606 027B  66| FF 46 F6			inc dword ptr [bp-10] ; +1 –≤ –
					ª—ñ—á–∏–ª—å–Ω–∏–∫ 
     607 027F  66| 8B 56 F6			mov edx,dword ptr [bp-10] 
     608 0283  66| 23 56 FA			and edx,[bp-6] ; –ø–µ—Ä–µ–≤—ñ—Ä
					–∫–∞ –Ω–∞ 0 
     609 0287  75 DE				jnz l20 
     610				 
     611 0289  07				pop es 
     612 028A  83 C4 0A				add sp,10 
     613 028D  8B 46 08				mov ax,[bp+8] 
     614 0290  25 000F				and ax,0fh 
     615 0293  FA				cli 
     616 0294  5D				pop bp 
     617 0295  C2 0006				ret 6 
     618 0298				Vcount endp 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-19


     619				 
     620				;===== 
     621 0298				show proc near 
     622 0298  55				push bp 
     623 0299  8B EC				mov bp,sp 
     624 029B  60				pusha 
     625 029C  06				push es 
     626 029D  B8 B800				mov ax,0b800h 
     627 02A0  8E C0				mov es,ax 
     628				 
     629 02A2  FD				std 
     630 02A3				ls20: 
     631 02A3  8B 7E 04				mov di,[bp+4] 
     632 02A6  8B 5E 06				mov bx,[bp+6] 
     633 02A9  B9 0004				mov cx,4 
     634 02AC				ls40: 
     635 02AC  8A C3				mov al,bl 
     636 02AE  24 0F				and al,00001111b 
     637 02B0  3C 0A				cmp al,10 
     638 02B2  0F 8C 02B8 R			jl ls100 
     639 02B6  04 07				add al,7 
     640 02B8				ls100: 
     641 02B8  04 30				add al,30h 
     642 02BA  AA				stosb 
     643 02BB  4F				dec di 
     644 02BC  C1 EB 04				shr bx,4 
     645 02BF  E2 EB				loop ls40 
     646				 
     647 02C1  07				pop es 
     648 02C2  61				popa 
     649 02C3  5D				pop bp 
     650 02C4  C2 0004				ret 4 
     651 02C7				show endp 
     652				 
     653				;--------------------------------------
					---------------------- 
     654				;--------------------------------------
					---------------------- 
     655				;--------------------------------------
					---------------------- 
     656 02C7				begin: 
     657 02C7  B8 ---- R			mov ax,_data 
     658 02CA  8E D8				mov ds,ax 
     659				 
     660 02CC  B8 0003				mov ax,3 ; –∑–∞–¥–∞—Ç–∏ —Ç–µ–∫—
					Å—Ç–æ–≤–∏–π —Ä–µ–∂–∏–º 80 –Ω–∞ 25 
     661 02CF  CD 10				int 10h 
     662				 
     663					; Clear screen 
     664 02D1  B8 B800				mov ax, 0b800h 
     665 02D4  8E C0				mov es, ax 
     666 02D6  BF 0000				mov di, 0 
     667 02D9  B4 0A				mov ah, 1010b 
     668 02DB  B0 20				mov al, ' ' 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-20


     669 02DD  B9 07D0				mov cx, 2000 
     670 02E0  F3/ AB				rep stosw 
     671				 
     672 02E2  B4 10				mov ah,10h ; –≤—ñ–¥–∫–ª—é—á–∏—Ç
					–∏ —Ä–µ–∂–∏–º –º–∏–≥–æ—Ç—ñ–Ω–Ω—è 
     673 02E4  B0 03				mov al,3 
     674 02E6  B3 00				mov bl,0 
     675 02E8  CD 10				int 10h 
     676					 
     677 02EA  B9 000A				mov cx,max_prg 
     678 02ED  66| 33 F6			xor esi, esi 
     679 02F0  BB 0004				mov bx, 4 
     680				 
     681 02F3				b10: 
     682 02F3  67| 89 1C75 0000005C		mov screen_addr[esi*2],bx ; –∑–
					∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ 
     683	R			
     684					 ; –∞–¥—Ä–µ—Å –≤–∏–≤–æ–¥—É –¥–ª
					—è –∑–∞–¥–∞—á 
     685 02FB  67| C6 86 0000002C R		mov init[esi],absent ; –ø–µ—Ä—à
					–æ–ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω
					—è 
     686       10			
     687					 ; —Ç–∞–±–ª–∏—Ü—ñ —Å—Ç–∞–Ω—É –∑
					–∞–¥–∞—á 
     688					 
     689 0303  83 C3 50				add bx, 80 
     690 0306  66| 46				inc esi 
     691				 
     692 0308  E2 E9				loop b10 
     693					;SETINT 
     694 030A  FA				cli ; –∑–∞–±–æ—Ä–æ–Ω–∞ –ø–µ—Ä–µ
					—Ä–∏–≤–∞–Ω—å 
     695				 
     696 030B  B4 34				mov ah,34h 
     697 030D  CD 21				int 21h ;es:bx - –∞–¥—Ä–µ—Å–∞ –
					æ–∑–Ω–∞–∫–∏ –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ MS-DOS
					 
     698 030F  89 1E 0000 R			mov word ptr @ms_dos_busy,bx 
     699 0313  8C 06 0002 R			mov word ptr @ms_dos_busy+2,es 
     700				 
     701 0317  E8 0000 R			call setint8 ;"–ø–µ—Ä–µ—Ö–æ–ø–ª
					–µ–Ω–Ω—è" int8 
     702 031A  E8 005F R			call setint9 ;"–ø–µ—Ä–µ—Ö–æ–ø–ª
					–µ–Ω–Ω—è" int9 
     703				 
     704 031D  0F B2 26 0006 R			lss sp,sssp ; —Å—Ç–µ–∫ —Ñ–æ–Ω–æ
					–≤–æ—ó –∑–∞–¥–∞—á—ñ 
     705 0322  C7 06 002A R 000A		mov nprg,fon 
     706 0328  68 464E				push 'FN' 
     707 032B  68 0708				push 1800 
     708 032E  6A 1E				push 30 
     709 0330  E8 021F R			call Vcount ; –∑–∞–ø—É—Å–∫ —Ñ–æ
					–Ω–æ–≤–æ—ó –∑–∞–¥–∞—á—ñ 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Page     1-21


     710					; –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä—ñ Vcount 
					—É—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –¥–æ–∑–≤—ñ
					–ª 
     711					;–Ω–∞ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è —ñ
					 –ø—Ä–∏ —á–µ—Ä–≥–æ–≤–∏—Ö –ø–µ—Ä–µ—Ä–∏–≤
					–∞–Ω–Ω—è—Ö 
     712					; –≤—ñ–¥ —Ç–∞–π–º–µ—Ä–∞ –º–µ–Ω–
					µ–¥–∂–µ—Ä –∫–≤–∞–Ω—Ç—ñ–≤ (userint8)  
     713					; –±—É–¥–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —
					ñ–Ω—à—ñ –∑–∞–¥–∞—á—ñ 
     714					; 
     715					; —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤ —Ü—é 
					—Ç–æ—á–∫—É –±—É–¥–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –ø
					–æ –∫–æ–º–∞–Ω–¥—ñ RET –ø–æ –∑–∞–≤–µ—Ä—à
					–µ–Ω—ñ —Ñ–æ–Ω–æ–≤–æ—ó 
     716				 
     717 0333  E8 003C R			call retint8 ; –≤—ñ–¥–Ω–æ–≤–ª–µ
					–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –≤–µ–∫—Ç–æ—Ä—
					ñ–≤  
     718 0336  E8 008F R			call retint9 
     719 0339  FB				sti 
     720				 
     721					; Clear screen 
     722 033A  B8 B800				mov ax, 0b800h 
     723 033D  8E C0				mov es, ax 
     724 033F  BF 0000				mov di, 0 
     725 0342  B4 0F				mov ah, 0Fh 
     726 0344  B0 20				mov al, ' ' 
     727 0346  B9 07D0				mov cx, 2000 
     728 0349  F3/ AB				rep stosw 
     729				 
     730 034B  B8 4C00				mov ax,4c00h 
     731 034E  CD 21				int 21h 
     732 0350				_TEXT ENDS 
     733				 
     734				end begin 
Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Symbols-1




                N a m e         	Size	Length	 Align	Combine Class

_DATA  . . . . . . . . . . . . .  	16 Bit	00A2	WORD	PUBLIC	'DATA'
_ST  . . . . . . . . . . . . . .  	16 Bit	FAC8	WORD	STACK	'STACK'
_TEXT  . . . . . . . . . . . . .  	16 Bit	0350	BYTE	PUBLIC	'CODE'

Symbols:            

                N a m e         	Type	 Value	 Attr

ABSENT . . . . . . . . . . . . .  	NUMBER	0010	

B10  . . . . . . . . . . . . . .  	L NEAR	02F3	_TEXT
BEGIN  . . . . . . . . . . . . .  	L NEAR	02C7	_TEXT

CHECKKEYS  . . . . . . . . . . .  	N PROC	01ED	_TEXT	Length = 0032
CHECKKEYSEND . . . . . . . . . .  	L NEAR	021B	_TEXT
CLK  . . . . . . . . . . . . . .  	L WORD	009C	_DATA
CLOCK  . . . . . . . . . . . . .  	L BYTE	003C	_DATA	Length = 0010
CLOCKT . . . . . . . . . . . . .  	L BYTE	004C	_DATA	Length = 0010
CLOSE  . . . . . . . . . . . . .  	NUMBER	0004	
CURSOR_POS . . . . . . . . . . .  	L WORD	00A0	_DATA

DISP005  . . . . . . . . . . . .  	L NEAR	012E	_TEXT
DISP010  . . . . . . . . . . . .  	L NEAR	013E	_TEXT
DISP015  . . . . . . . . . . . .  	L NEAR	014E	_TEXT
DISP018  . . . . . . . . . . . .  	L NEAR	0161	_TEXT
DISP020  . . . . . . . . . . . .  	L NEAR	0188	_TEXT
DISP100  . . . . . . . . . . . .  	L NEAR	01A5	_TEXT

ESC_KEY  . . . . . . . . . . . .  	NUMBER	0001	
EXECUTE  . . . . . . . . . . . .  	NUMBER	0001	

FON  . . . . . . . . . . . . . .  	ALIAS	 MAX_PRG		
FONSP  . . . . . . . . . . . . .  	L WORD	0006	_DATA

HESITATION . . . . . . . . . . .  	NUMBER	0002	

INIT . . . . . . . . . . . . . .  	L BYTE	002C	_DATA	Length = 0010
INT8PTR  . . . . . . . . . . . .  	L WORD	0038	_TEXT	Length = 0002
INT8SET  . . . . . . . . . . . .  	L BYTE	0004	_DATA
INT9PTR  . . . . . . . . . . . .  	L WORD	008B	_TEXT	Length = 0002
INT9SET  . . . . . . . . . . . .  	L BYTE	0005	_DATA

L20  . . . . . . . . . . . . . .  	L NEAR	0267	_TEXT
L40  . . . . . . . . . . . . . .  	L NEAR	026C	_TEXT
L60  . . . . . . . . . . . . . .  	L NEAR	0277	_TEXT
LABEL101 . . . . . . . . . . . .  	L NEAR	0206	_TEXT
LS100  . . . . . . . . . . . . .  	L NEAR	02B8	_TEXT
LS20 . . . . . . . . . . . . . .  	L NEAR	02A3	_TEXT
LS40 . . . . . . . . . . . . . .  	L NEAR	02AC	_TEXT

Microsoft (R) Macro Assembler Version 5.00                  5/23/19 11:10:08
                                                             Symbols-2


MAX_PRG  . . . . . . . . . . . .  	NUMBER	000A	
MOUSE_STATE  . . . . . . . . . .  	L WORD	009E	_DATA

NAMES  . . . . . . . . . . . . .  	L WORD	007C	_DATA
NEXTELEMENT  . . . . . . . . . .  	L NEAR	0214	_TEXT
NPRG . . . . . . . . . . . . . .  	L WORD	002A	_DATA

READY  . . . . . . . . . . . . .  	NUMBER	0000	
RETINT8  . . . . . . . . . . . .  	N PROC	003C	_TEXT	Length = 0023
RETINT9  . . . . . . . . . . . .  	N PROC	008F	_TEXT	Length = 001A

SCREEN_ADDR  . . . . . . . . . .  	L WORD	005C	_DATA	Length = 0010
SETINT8  . . . . . . . . . . . .  	N PROC	0000	_TEXT	Length = 003C
SETINT9  . . . . . . . . . . . .  	N PROC	005F	_TEXT	Length = 0030
SHOW . . . . . . . . . . . . . .  	N PROC	0298	_TEXT	Length = 002F
SSSP . . . . . . . . . . . . . .  	L DWORD	0006	_DATA
STOP . . . . . . . . . . . . . .  	NUMBER	0008	
STP  . . . . . . . . . . . . . .  	L WORD	000A	_DATA

TASKSLOOP  . . . . . . . . . . .  	L NEAR	0206	_TEXT
TIME_SLICE . . . . . . . . . . .  	NUMBER	FFFF	
TOP  . . . . . . . . . . . . . .  	L WORD	FA00	_ST

UI9010 . . . . . . . . . . . . .  	L NEAR	00B4	_TEXT
UI9020 . . . . . . . . . . . . .  	L NEAR	00D0	_TEXT
UI9040 . . . . . . . . . . . . .  	L NEAR	00F0	_TEXT
USERINT8 . . . . . . . . . . . .  	F PROC	00F3	_TEXT	Length = 00FA
USERINT9 . . . . . . . . . . . .  	F PROC	00A9	_TEXT	Length = 004A

VCOUNT . . . . . . . . . . . . .  	N PROC	021F	_TEXT	Length = 0079

ZERO_8 . . . . . . . . . . . . .  	L NEAR	0037	_TEXT
ZERO_9 . . . . . . . . . . . . .  	L NEAR	008A	_TEXT

@FILENAME  . . . . . . . . . . .  	TEXT  lab6		
@MS_DOS_BUSY . . . . . . . . . .  	L DWORD	0000	_DATA


    699 Source  Lines
    699 Total   Lines
     68 Symbols

  50436 + 416956 Bytes symbol space free

      0 Warning Errors
      0 Severe  Errors
